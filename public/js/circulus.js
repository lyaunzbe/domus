// Generated by CoffeeScript 1.6.3
jQuery(function() {
  var circle, ctx, cvs, frameHeight, frameWidth, num, points, radius, render, rotation, speed, start, x_factor;
  frameHeight = 800;
  frameWidth = 1120;
  start = 0;
  $('<canvas id="sketch">').appendTo('.sketch').attr('width', frameWidth).attr('height', frameHeight);
  cvs = document.getElementById('sketch');
  ctx = cvs.getContext('2d');
  num = 55;
  radius = 25;
  rotation = 2 * Math.PI / num;
  speed = .5;
  x_factor = 10;
  circle = function(x, y, r, col) {
    ctx.beginPath();
    ctx.arc(x, y, r, 0, 2.0 * Math.PI, false);
    ctx.fillStyle = col.toString();
    return ctx.fill();
  };
  points = function(angle, amp) {
    return {
      x: frameWidth / 2 + Math.cos(angle) * amp,
      y: frameHeight / 2 + Math.sin(angle) * amp
    };
  };
  render = function(t) {
    var amp, col, i, pos, slice;
    i = 0;
    ctx.clearRect(0, 0, frameWidth, frameHeight);
    t = t / 1000;
    if (Math.floor(t) % 5 === 0) {
      x_factor++;
    }
    while (i < num) {
      slice = x_factor * Math.PI / num;
      amp = (Math.cos(speed * t + slice * i) * 90) + -165;
      pos = points(rotation * i, amp);
      col = d3.hsl(i * (360 / num), 1, 0.4784);
      circle(pos.x, pos.y, radius, col);
      i++;
    }
    return requestAnimFrame(render);
  };
  return (function() {
    console.log('yo');
    if (window.performance.now) {
      start = window.performance.now();
    } else {
      start = Date.now();
    }
    return requestAnimFrame(render);
  })();
});
